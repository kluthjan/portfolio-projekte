<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freelance Buddy | Dein Tarif-Rechner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            blue: '#4F46E5',
                            light: '#EEF2FF',
                            mint: '#10B981',
                            coral: '#F43F5E',
                            sunny: '#F59E0b'
                        }
                    },
                    boxShadow: {
                        'soft': '0 10px 25px -5px rgba(79, 70, 229, 0.1), 0 8px 10px -6px rgba(79, 70, 229, 0.1)',
                        'inner-soft': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.05)'
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #F8FAFC; 
            color: #334155; 
            overflow-x: hidden;
        }

        /* --- Tooltips --- */
        .tooltip-trigger:hover + .tooltip-content {
            display: flex;
            opacity: 1;
            transform: translate(-50%, -10px) scale(1);
        }
        
        /* --- Slider Styles --- */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
            margin: 10px 0;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 12px;
            background: #E2E8F0;
            border-radius: 20px;
            border: 2px solid #fff;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
            cursor: pointer;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 28px; width: 28px;
            border-radius: 50%;
            background: #4F46E5;
            border: 4px solid #fff;
            box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
            cursor: grab;
            margin-top: -10px; 
            transition: transform 0.2s ease;
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }
        
        #in-costs::-webkit-slider-thumb { background: #F43F5E; box-shadow: 0 4px 10px rgba(244, 63, 94, 0.3); }
        #in-hours::-webkit-slider-thumb { background: #F59E0b; box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3); }
        #in-days::-webkit-slider-thumb { background: #10B981; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); }

        /* Animation Blobs */
        .blob { position: absolute; filter: blur(80px); opacity: 0.4; z-index: 0; }
        @keyframes blob { 
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob { animation: blob 7s infinite; }
        .animation-delay-2000 { animation-delay: 2s; }
    </style>
</head>
<body class="min-h-screen p-6 md:p-12 flex items-center justify-center relative bg-slate-50">

    <div class="blob top-0 left-0 w-96 h-96 bg-brand-blue rounded-full mix-blend-multiply animate-blob"></div>
    <div class="blob bottom-0 right-0 w-96 h-96 bg-brand-coral rounded-full mix-blend-multiply animate-blob animation-delay-2000"></div>

    <main class="w-full max-w-6xl bg-white/80 backdrop-blur-xl rounded-[3rem] shadow-soft p-8 md:p-12 relative z-10 grid grid-cols-1 lg:grid-cols-12 gap-12 border border-white">
        
        <section class="lg:col-span-5 space-y-8">
            <div>
                <h1 class="text-3xl font-black text-slate-800 tracking-tight mb-2">Hallo Freelancer! üëã</h1>
                <p class="text-slate-500 font-medium">Lass uns herausfinden, was du wirklich verdienen solltest.</p>
            </div>

            <div class="space-y-10 py-4">
                
                <div class="relative">
                    <div class="flex justify-between items-end mb-3">
                        <label class="font-bold text-slate-700 flex items-center gap-2">
                            üí∞ Dein Wunsch-Netto
                            <div class="relative flex flex-col items-center group pointer-events-auto">
                                <div class="tooltip-trigger bg-brand-light text-brand-blue rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold cursor-help">i</div>
                                <div class="tooltip-content absolute bottom-full mb-2 hidden flex-col items-center w-64 bg-slate-800 text-white text-sm p-4 rounded-2xl shadow-lg transition-all z-50 text-center">
                                    Das Geld, das jeden Monat privat auf deinem Konto landen soll.
                                </div>
                            </div>
                        </label>
                        <span class="text-3xl font-black text-brand-blue"><span id="val-income">4000</span> ‚Ç¨</span>
                    </div>
                    <input type="range" id="in-income" min="2000" max="12000" step="100" value="4000">
                </div>

                <div class="relative">
                    <div class="flex justify-between items-end mb-3">
                        <label class="font-bold text-slate-700 flex items-center gap-2">
                            üìâ Business Kosten
                        </label>
                        <span class="text-3xl font-black text-brand-coral"><span id="val-costs">1200</span> ‚Ç¨</span>
                    </div>
                    <input type="range" id="in-costs" min="0" max="4000" step="50" value="1200">
                </div>

                <div class="relative">
                    <div class="flex justify-between items-end mb-3">
                        <label class="font-bold text-slate-700 flex items-center gap-2">
                            ‚è±Ô∏è Stunden/Tag
                        </label>
                        <span class="text-3xl font-black text-brand-sunny"><span id="val-hours">5.0</span> h</span>
                    </div>
                    <input type="range" id="in-hours" min="3" max="9" step="0.5" value="5">
                </div>

                 <div class="relative">
                    <div class="flex justify-between items-end mb-3">
                        <label class="font-bold text-slate-700 flex items-center gap-2">
                            üìÖ Tage/Jahr
                        </label>
                        <span class="text-3xl font-black text-brand-mint"><span id="val-days">210</span> d</span>
                    </div>
                    <input type="range" id="in-days" min="150" max="240" step="5" value="210">
                </div>

            </div>
        </section>

        <section class="lg:col-span-7 bg-brand-light/50 rounded-[2.5rem] p-8 lg:p-10 flex flex-col justify-between border border-blue-100 shadow-inner-soft">
            
            <div class="text-center lg:text-left mb-8">
                <h3 class="text-lg font-bold text-slate-500 mb-2 uppercase tracking-wider">Dein Ziel-Stundensatz</h3>
                <div class="flex items-center justify-center lg:justify-start gap-4">
                    <div class="text-7xl lg:text-8xl font-black text-brand-blue tracking-tighter drop-shadow-sm" id="res-hourly">0</div>
                    <div class="text-4xl text-slate-400 font-bold">‚Ç¨/h</div>
                </div>
                <div class="inline-flex items-center gap-2 mt-4 bg-white px-4 py-2 rounded-full shadow-sm text-sm font-bold text-slate-600">
                    <span>üëâ</span> Tagessatz (8h): <span id="res-daily" class="text-brand-blue">0 ‚Ç¨</span>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-grow">
                <div class="bg-white rounded-3xl p-6 shadow-sm border border-slate-100 relative overflow-hidden">
                    <h4 class="font-bold text-slate-800 flex items-center gap-2 mb-4">
                        <span class="text-xl">ü§ñ</span> Mein Feedback
                    </h4>
                    <p id="advisor-text" class="text-slate-600 leading-relaxed font-medium">Berechne...</p>
                </div>

                <div class="bg-white rounded-3xl p-6 shadow-sm border border-slate-100 relative transform rotate-1 hover:rotate-0 transition-transform">
                    <h4 class="font-bold text-slate-800 flex items-center gap-2 mb-4">
                        <span class="text-xl">üìÑ</span> Rechnung (Beispiel 10h)
                    </h4>
                     <div class="space-y-2 text-sm font-medium text-slate-500">
                        <div class="flex justify-between">
                            <span>Honorar (Netto)</span>
                            <span id="inv-net">0 ‚Ç¨</span>
                        </div>
                        <div class="flex justify-between text-slate-400">
                            <span>+ 19% MwSt.</span>
                            <span id="inv-vat">0 ‚Ç¨</span>
                        </div>
                        <div class="h-0.5 bg-slate-100 my-2 rounded-full"></div>
                        <div class="flex justify-between text-slate-800 font-black text-lg">
                            <span>Summe</span>
                            <span class="text-brand-blue" id="inv-total">0 ‚Ç¨</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 space-y-6">
                <div>
                     <h4 class="font-bold text-slate-500 text-sm mb-3 uppercase tracking-wider">Wohin dein Umsatz flie√üt</h4>
                     <div class="w-full h-8 bg-white rounded-full overflow-hidden flex shadow-sm border border-slate-100 text-xs font-black text-white text-center leading-8">
                        <div id="bar-net" class="bg-brand-blue transition-all duration-500" style="width: 40%">NETTO</div>
                        <div id="bar-tax" class="bg-slate-400 transition-all duration-500" style="width: 35%">STEUER</div>
                        <div id="bar-costs" class="bg-brand-coral transition-all duration-500" style="width: 25%">KOSTEN</div>
                    </div>
                </div>

                <div class="pt-6 border-t border-blue-100 flex flex-col md:flex-row items-center justify-between gap-4">
                    <p class="text-sm font-medium text-slate-500">Kalkulation speichern?</p>
                    <button onclick="sendEmail()" class="group bg-gradient-to-r from-brand-blue to-indigo-600 text-white px-8 py-4 rounded-2xl font-black shadow-soft hover:shadow-xl hover:-translate-y-1 transition-all flex items-center gap-3">
                        <span>‚úâÔ∏è</span> Per E-Mail senden
                    </button>
                </div>
            </div>
        </section>
    </main>

    <script>
        // DOM Elemente sicher ausw√§hlen
        const inputs = {
            income: document.getElementById('in-income'),
            costs: document.getElementById('in-costs'),
            hours: document.getElementById('in-hours'),
            days: document.getElementById('in-days'),
        };

        const labels = {
            income: document.getElementById('val-income'),
            costs: document.getElementById('val-costs'),
            hours: document.getElementById('val-hours'),
            days: document.getElementById('val-days'),
        };

        const display = {
            hourly: document.getElementById('res-hourly'),
            daily: document.getElementById('res-daily'),
            advisor: document.getElementById('advisor-text'),
            invNet: document.getElementById('inv-net'),
            invVat: document.getElementById('inv-vat'),
            invTotal: document.getElementById('inv-total'),
            barNet: document.getElementById('bar-net'),
            barTax: document.getElementById('bar-tax'),
            barCosts: document.getElementById('bar-costs'),
        };

        // Globale Variablen f√ºr den Mailversand
        let currentHourlyRate = 0; // HIER WAR DER FEHLER
        let currentYearlyRevenue = 0;

        // W√§hrungsformatierer
        const formatter = new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' });

        function calculate() {
            // Werte auslesen
            const net = parseInt(inputs.income.value);
            const costs = parseInt(inputs.costs.value);
            const hours = parseFloat(inputs.hours.value);
            const days = parseInt(inputs.days.value);

            // Labels updaten
            labels.income.innerText = net;
            labels.costs.innerText = costs;
            labels.hours.innerText = hours;
            labels.days.innerText = days;

            // Logik
            const yearlyNet = net * 12;
            const yearlyCosts = costs * 12;
            
            // Steuer-Faustformel: Wer X Netto will, muss ca. das 1.8-fache erwirtschaften (bei hohen Einkommen)
            // Wir rechnen hier konservativ mit ca 45% Abz√ºgen vom Umsatz f√ºr KV/RV/Steuer
            const taxFactor = 0.55; // 55% bleiben √ºbrig
            
            // Notwendiger Umsatzanteil f√ºr das Netto
            const revenueForIncome = yearlyNet / taxFactor;
            
            // Gesamtziel
            const totalRevenueTarget = revenueForIncome + yearlyCosts;
            
            // Stundenberechnung
            const totalHours = days * hours;
            const hourlyRate = totalRevenueTarget / totalHours;

            // Globale Werte speichern
            currentHourlyRate = Math.ceil(hourlyRate);
            currentYearlyRevenue = Math.round(totalRevenueTarget);

            // UI Updates
            display.hourly.innerText = currentHourlyRate;
            display.daily.innerText = formatter.format(currentHourlyRate * 8);

            // Rechnungsvorschau (10h)
            const exNet = currentHourlyRate * 10;
            const exVat = exNet * 0.19;
            display.invNet.innerText = formatter.format(exNet);
            display.invVat.innerText = formatter.format(exVat);
            display.invTotal.innerText = formatter.format(exNet + exVat);

            // Balkendiagramm
            const pNet = (yearlyNet / totalRevenueTarget) * 100;
            const pCosts = (yearlyCosts / totalRevenueTarget) * 100;
            const pTax = 100 - pNet - pCosts; // Rest ist Steuer

            display.barNet.style.width = `${pNet}%`;
            display.barTax.style.width = `${pTax}%`;
            display.barCosts.style.width = `${pCosts}%`;

            // Advisor Text
            updateAdvisor(currentHourlyRate);
        }

        function updateAdvisor(rate) {
            let text = "";
            if (rate < 75) {
                text = "‚ö†Ô∏è Ziemlich knapp! Du deckst deine Kosten, aber f√ºr Altersvorsorge oder Krankheit bleibt wenig. Versuch, deinen Wert zu steigern.";
                display.advisor.style.color = "#F43F5E"; // Rot
            } else if (rate < 110) {
                text = "‚úÖ Solider Bereich! Das ist ein fairer Satz f√ºr erfahrene Freelancer. Du kannst davon gut leben und R√ºcklagen bilden.";
                display.advisor.style.color = "#334155"; // Grau
            } else {
                text = "üöÄ Exzellent! Du bist im Experten-Bereich. Dieser Preis filtert schwierige Kunden aus und gibt dir unternehmerische Freiheit.";
                display.advisor.style.color = "#4F46E5"; // Blau
            }
            display.advisor.innerText = text;
        }

        function sendEmail() {
            const subject = "Meine Freelance Kalkulation";
            const body = `Hallo!\n\nHier ist meine Kalkulation aus dem Freelance Buddy:\n\n` +
                         `--- ZIELE ---\n` +
                         `Wunsch-Netto: ${inputs.income.value} ‚Ç¨\n` +
                         `Kosten: ${inputs.costs.value} ‚Ç¨\n\n` +
                         `--- ERGEBNIS ---\n` +
                         `Stundensatz: ${currentHourlyRate} ‚Ç¨\n` +
                         `Jahresumsatz Ziel: ${formatter.format(currentYearlyRevenue)}\n\n` +
                         `Viele Gr√º√üe!`;
            
            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }

        // Event Listeners hinzuf√ºgen
        inputs.income.addEventListener('input', calculate);
        inputs.costs.addEventListener('input', calculate);
        inputs.hours.addEventListener('input', calculate);
        inputs.days.addEventListener('input', calculate);

        // Einmal initial berechnen beim Laden
        calculate();

    </script>
</body>
</html>